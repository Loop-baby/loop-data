
-- programamtically generated base CTE
WITH base AS (

        SELECT
        'baby_on_the_way_join' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    baby_on_the_way_join.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    baby_on_the_way_join.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    baby_on_the_way_join.context_ip,
                    baby_on_the_way_join.context_library_name,
                    baby_on_the_way_join.context_library_version,
                    baby_on_the_way_join.context_locale,
                    baby_on_the_way_join.context_page_path,
                    NULL AS context_page_referrer,
                    baby_on_the_way_join.context_page_search,
                    baby_on_the_way_join.context_page_title,
                    baby_on_the_way_join.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    baby_on_the_way_join.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    baby_on_the_way_join.event,
                    baby_on_the_way_join.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    baby_on_the_way_join.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    baby_on_the_way_join.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    baby_on_the_way_join.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    baby_on_the_way_join.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    baby_on_the_way_join.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    baby_on_the_way_join.uuid,
                    baby_on_the_way_join.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.baby_on_the_way_join


            UNION ALL


        SELECT
        'cart_viewed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    cart_viewed.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    cart_viewed.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    cart_viewed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    cart_viewed.context_integration_name,
                    cart_viewed.context_integration_version,
                    cart_viewed.context_ip,
                    cart_viewed.context_library_name,
                    cart_viewed.context_library_version,
                    cart_viewed.context_locale,
                    cart_viewed.context_page_path,
                    cart_viewed.context_page_referrer,
                    NULL AS context_page_search,
                    cart_viewed.context_page_title,
                    cart_viewed.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    cart_viewed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    cart_viewed.event,
                    cart_viewed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    cart_viewed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    cart_viewed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    cart_viewed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    cart_viewed.sent_at,
                    cart_viewed.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    cart_viewed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    cart_viewed.user_id,
                    cart_viewed.uuid,
                    cart_viewed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.cart_viewed


            UNION ALL


        SELECT
        'checkout_started' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    checkout_started.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    checkout_started.anonymous_id,
                    NULL AS brand,
                    checkout_started.cart_id,
                    checkout_started.category,
                    checkout_started.checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    checkout_started.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    checkout_started.context_integration_name,
                    checkout_started.context_integration_version,
                    checkout_started.context_ip,
                    checkout_started.context_library_name,
                    checkout_started.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    checkout_started.coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    checkout_started.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    checkout_started.discount,
                    checkout_started.email,
                    checkout_started.event,
                    checkout_started.event_text,
                    checkout_started.fbc,
                    checkout_started.fbp,
                    NULL AS first_name,
                    checkout_started.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    checkout_started.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    checkout_started.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    checkout_started.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    checkout_started.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    checkout_started.sent_at,
                    checkout_started.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    checkout_started.source_name,
                    NULL AS state,
                    checkout_started.step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    checkout_started.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    checkout_started.user_id,
                    checkout_started.uuid,
                    checkout_started.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.checkout_started


            UNION ALL


        SELECT
        'checkout_step_completed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    checkout_step_completed.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    checkout_step_completed.anonymous_id,
                    NULL AS brand,
                    checkout_step_completed.cart_id,
                    checkout_step_completed.category,
                    checkout_step_completed.checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    checkout_step_completed.context_external_ids,
                    checkout_step_completed.context_google_analytics_client_id,
                    checkout_step_completed.context_google_analytics_geoid,
                    checkout_step_completed.context_integration_name,
                    checkout_step_completed.context_integration_version,
                    checkout_step_completed.context_ip,
                    checkout_step_completed.context_library_name,
                    checkout_step_completed.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    checkout_step_completed.coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    checkout_step_completed.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    checkout_step_completed.discount,
                    checkout_step_completed.email,
                    checkout_step_completed.event,
                    checkout_step_completed.event_text,
                    checkout_step_completed.fbc,
                    checkout_step_completed.fbp,
                    NULL AS first_name,
                    checkout_step_completed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    checkout_step_completed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    checkout_step_completed.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    checkout_step_completed.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    checkout_step_completed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    checkout_step_completed.sent_at,
                    checkout_step_completed.sent_from,
                    NULL AS shipping,
                    checkout_step_completed.shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    checkout_step_completed.source_name,
                    NULL AS state,
                    checkout_step_completed.step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    checkout_step_completed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    checkout_step_completed.user_id,
                    checkout_step_completed.uuid,
                    checkout_step_completed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.checkout_step_completed


            UNION ALL


        SELECT
        'checkout_step_viewed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    checkout_step_viewed.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    checkout_step_viewed.anonymous_id,
                    NULL AS brand,
                    checkout_step_viewed.cart_id,
                    checkout_step_viewed.category,
                    checkout_step_viewed.checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    checkout_step_viewed.context_external_ids,
                    checkout_step_viewed.context_google_analytics_client_id,
                    checkout_step_viewed.context_google_analytics_geoid,
                    checkout_step_viewed.context_integration_name,
                    checkout_step_viewed.context_integration_version,
                    checkout_step_viewed.context_ip,
                    checkout_step_viewed.context_library_name,
                    checkout_step_viewed.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    checkout_step_viewed.coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    checkout_step_viewed.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    checkout_step_viewed.discount,
                    checkout_step_viewed.email,
                    checkout_step_viewed.event,
                    checkout_step_viewed.event_text,
                    checkout_step_viewed.fbc,
                    checkout_step_viewed.fbp,
                    NULL AS first_name,
                    checkout_step_viewed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    checkout_step_viewed.original_timestamp,
                    NULL AS path,
                    checkout_step_viewed.payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    checkout_step_viewed.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    checkout_step_viewed.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    checkout_step_viewed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    checkout_step_viewed.sent_at,
                    checkout_step_viewed.sent_from,
                    NULL AS shipping,
                    checkout_step_viewed.shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    checkout_step_viewed.source_name,
                    NULL AS state,
                    checkout_step_viewed.step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    checkout_step_viewed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    checkout_step_viewed.user_id,
                    checkout_step_viewed.uuid,
                    checkout_step_viewed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.checkout_step_viewed


            UNION ALL


        SELECT
        'coupon_applied' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    coupon_applied.anonymous_id,
                    NULL AS brand,
                    coupon_applied.cart_id,
                    coupon_applied.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    coupon_applied.context_google_analytics_client_id,
                    coupon_applied.context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    NULL AS context_ip,
                    coupon_applied.context_library_name,
                    coupon_applied.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    NULL AS coupon,
                    coupon_applied.coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    coupon_applied.event,
                    coupon_applied.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    coupon_applied.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    coupon_applied.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    coupon_applied.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    coupon_applied.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    coupon_applied.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    coupon_applied.uuid,
                    coupon_applied.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.coupon_applied


            UNION ALL


        SELECT
        'current_parent_header_button' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    current_parent_header_button.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    current_parent_header_button.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    current_parent_header_button.context_ip,
                    current_parent_header_button.context_library_name,
                    current_parent_header_button.context_library_version,
                    current_parent_header_button.context_locale,
                    current_parent_header_button.context_page_path,
                    NULL AS context_page_referrer,
                    current_parent_header_button.context_page_search,
                    current_parent_header_button.context_page_title,
                    current_parent_header_button.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    current_parent_header_button.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    current_parent_header_button.event,
                    current_parent_header_button.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    current_parent_header_button.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    current_parent_header_button.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    current_parent_header_button.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    current_parent_header_button.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    current_parent_header_button.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    current_parent_header_button.uuid,
                    current_parent_header_button.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.current_parent_header_button


            UNION ALL


        SELECT
        'customer_created' as src_tbl,
                    customer_created._id,
                    customer_created.accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    customer_created.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    customer_created.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    customer_created.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    customer_created.context_integration_name,
                    customer_created.context_integration_version,
                    NULL AS context_ip,
                    customer_created.context_library_name,
                    customer_created.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    customer_created.created_at,
                    NULL AS currency,
                    customer_created.customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    customer_created.email,
                    customer_created.event,
                    customer_created.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    customer_created.first_name,
                    customer_created.id,
                    NULL AS image_url,
                    customer_created.last_name,
                    NULL AS list_id,
                    customer_created.marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    customer_created.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    customer_created.purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    customer_created.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    customer_created.sent_at,
                    customer_created.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    customer_created.state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    customer_created.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    customer_created.user_id,
                    customer_created.uuid,
                    customer_created.uuid_ts,
                    NULL AS variant,
                    customer_created.verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.customer_created


            UNION ALL


        SELECT
        'customer_enabled' as src_tbl,
                    customer_enabled._id,
                    customer_enabled.accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    NULL AS anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    customer_enabled.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    customer_enabled.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    customer_enabled.context_integration_name,
                    customer_enabled.context_integration_version,
                    NULL AS context_ip,
                    customer_enabled.context_library_name,
                    customer_enabled.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    customer_enabled.created_at,
                    NULL AS currency,
                    customer_enabled.customer_lifetime_value,
                    customer_enabled.default_address_city,
                    customer_enabled.default_address_country,
                    customer_enabled.default_address_postal_code,
                    customer_enabled.default_address_state,
                    customer_enabled.default_address_street,
                    NULL AS discount,
                    customer_enabled.email,
                    customer_enabled.event,
                    customer_enabled.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    customer_enabled.first_name,
                    customer_enabled.id,
                    NULL AS image_url,
                    customer_enabled.last_name,
                    NULL AS list_id,
                    customer_enabled.marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    customer_enabled.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    customer_enabled.phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    customer_enabled.purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    customer_enabled.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    customer_enabled.sent_at,
                    customer_enabled.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    customer_enabled.state,
                    NULL AS step,
                    NULL AS subtotal,
                    customer_enabled.tags,
                    NULL AS tax,
                    customer_enabled.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    customer_enabled.user_id,
                    customer_enabled.uuid,
                    customer_enabled.uuid_ts,
                    NULL AS variant,
                    customer_enabled.verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.customer_enabled


            UNION ALL


        SELECT
        'df' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    df.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    df.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    df.context_ip,
                    df.context_library_name,
                    df.context_library_version,
                    df.context_locale,
                    df.context_page_path,
                    NULL AS context_page_referrer,
                    df.context_page_search,
                    df.context_page_title,
                    df.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    df.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    df.event,
                    df.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    df.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    df.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    df.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    df.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    df.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    df.uuid,
                    df.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.df


            UNION ALL


        SELECT
        'expectant_parent_header_button' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    expectant_parent_header_button.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    expectant_parent_header_button.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    expectant_parent_header_button.context_ip,
                    expectant_parent_header_button.context_library_name,
                    expectant_parent_header_button.context_library_version,
                    expectant_parent_header_button.context_locale,
                    expectant_parent_header_button.context_page_path,
                    NULL AS context_page_referrer,
                    expectant_parent_header_button.context_page_search,
                    expectant_parent_header_button.context_page_title,
                    expectant_parent_header_button.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    expectant_parent_header_button.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    expectant_parent_header_button.event,
                    expectant_parent_header_button.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    expectant_parent_header_button.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    expectant_parent_header_button.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    expectant_parent_header_button.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    expectant_parent_header_button.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    expectant_parent_header_button.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    expectant_parent_header_button.uuid,
                    expectant_parent_header_button.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.expectant_parent_header_button


            UNION ALL


        SELECT
        'join_current_parent_pressed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    join_current_parent_pressed.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    join_current_parent_pressed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    join_current_parent_pressed.context_ip,
                    join_current_parent_pressed.context_library_name,
                    join_current_parent_pressed.context_library_version,
                    join_current_parent_pressed.context_locale,
                    join_current_parent_pressed.context_page_path,
                    NULL AS context_page_referrer,
                    join_current_parent_pressed.context_page_search,
                    join_current_parent_pressed.context_page_title,
                    join_current_parent_pressed.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    join_current_parent_pressed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    join_current_parent_pressed.event,
                    join_current_parent_pressed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    join_current_parent_pressed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    join_current_parent_pressed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    join_current_parent_pressed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    join_current_parent_pressed.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    join_current_parent_pressed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    join_current_parent_pressed.uuid,
                    join_current_parent_pressed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.join_current_parent_pressed


            UNION ALL


        SELECT
        'join_expectant_parent_pressed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    join_expectant_parent_pressed.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    join_expectant_parent_pressed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    join_expectant_parent_pressed.context_ip,
                    join_expectant_parent_pressed.context_library_name,
                    join_expectant_parent_pressed.context_library_version,
                    join_expectant_parent_pressed.context_locale,
                    join_expectant_parent_pressed.context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    join_expectant_parent_pressed.context_page_title,
                    join_expectant_parent_pressed.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    join_expectant_parent_pressed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    join_expectant_parent_pressed.event,
                    join_expectant_parent_pressed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    join_expectant_parent_pressed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    join_expectant_parent_pressed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    join_expectant_parent_pressed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    join_expectant_parent_pressed.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    join_expectant_parent_pressed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    join_expectant_parent_pressed.uuid,
                    join_expectant_parent_pressed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.join_expectant_parent_pressed


            UNION ALL


        SELECT
        'membership_added_to_cart' as src_tbl,
                    membership_added_to_cart._id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    membership_added_to_cart.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    membership_added_to_cart.context_campaign_medium,
                    membership_added_to_cart.context_campaign_name,
                    membership_added_to_cart.context_campaign_source,
                    NULL AS context_external_ids,
                    membership_added_to_cart.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    membership_added_to_cart.context_ip,
                    membership_added_to_cart.context_library_name,
                    membership_added_to_cart.context_library_version,
                    membership_added_to_cart.context_locale,
                    membership_added_to_cart.context_page_path,
                    membership_added_to_cart.context_page_referrer,
                    membership_added_to_cart.context_page_search,
                    membership_added_to_cart.context_page_title,
                    membership_added_to_cart.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    membership_added_to_cart.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    membership_added_to_cart.email,
                    membership_added_to_cart.event,
                    membership_added_to_cart.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    membership_added_to_cart.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    membership_added_to_cart.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    membership_added_to_cart.quantity,
                    NULL AS query,
                    membership_added_to_cart.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    membership_added_to_cart.selling_plan,
                    membership_added_to_cart.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    membership_added_to_cart.timestamp,
                    NULL AS title,
                    NULL AS total,
                    membership_added_to_cart.type,
                    NULL AS url,
                    membership_added_to_cart.user_id,
                    membership_added_to_cart.uuid,
                    membership_added_to_cart.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.membership_added_to_cart


            UNION ALL


        SELECT
        'order_completed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    order_completed.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    order_completed.affiliation,
                    order_completed.anonymous_id,
                    NULL AS brand,
                    order_completed.cart_id,
                    order_completed.category,
                    order_completed.checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    order_completed.context_external_ids,
                    order_completed.context_google_analytics_client_id,
                    order_completed.context_google_analytics_geoid,
                    order_completed.context_integration_name,
                    order_completed.context_integration_version,
                    order_completed.context_ip,
                    order_completed.context_library_name,
                    order_completed.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    order_completed.coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    order_completed.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    order_completed.discount,
                    order_completed.email,
                    order_completed.event,
                    order_completed.event_text,
                    NULL AS fbc,
                    order_completed.fbp,
                    NULL AS first_name,
                    order_completed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    order_completed.order_id,
                    order_completed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    order_completed.presentment_amount,
                    order_completed.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    order_completed.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    order_completed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    order_completed.sent_at,
                    order_completed.sent_from,
                    order_completed.shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    order_completed.source_name,
                    NULL AS state,
                    NULL AS step,
                    order_completed.subtotal,
                    NULL AS tags,
                    order_completed.tax,
                    order_completed.timestamp,
                    NULL AS title,
                    order_completed.total,
                    NULL AS type,
                    NULL AS url,
                    order_completed.user_id,
                    order_completed.uuid,
                    order_completed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.order_completed


            UNION ALL


        SELECT
        'order_refunded' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    order_refunded.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    order_refunded.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    order_refunded.category,
                    order_refunded.checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    order_refunded.context_external_ids,
                    order_refunded.context_google_analytics_client_id,
                    order_refunded.context_google_analytics_geoid,
                    order_refunded.context_integration_name,
                    order_refunded.context_integration_version,
                    NULL AS context_ip,
                    order_refunded.context_library_name,
                    order_refunded.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    order_refunded.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    order_refunded.email,
                    order_refunded.event,
                    order_refunded.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    order_refunded.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    order_refunded.order_id,
                    order_refunded.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    order_refunded.presentment_amount,
                    order_refunded.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    order_refunded.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    order_refunded.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    order_refunded.refund_reason,
                    NULL AS results,
                    order_refunded.revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    order_refunded.sent_at,
                    order_refunded.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    order_refunded.source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    order_refunded.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    order_refunded.user_id,
                    order_refunded.uuid,
                    order_refunded.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.order_refunded


            UNION ALL


        SELECT
        'pages' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    pages.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    pages.context_campaign_content,
                    pages.context_campaign_medium,
                    pages.context_campaign_name,
                    pages.context_campaign_source,
                    NULL AS context_external_ids,
                    pages.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    pages.context_integration_name,
                    pages.context_integration_version,
                    pages.context_ip,
                    pages.context_library_name,
                    pages.context_library_version,
                    pages.context_locale,
                    pages.context_page_path,
                    pages.context_page_referrer,
                    pages.context_page_search,
                    pages.context_page_title,
                    pages.context_page_url,
                    pages.context_traits_default_address_city,
                    pages.context_traits_default_address_country,
                    pages.context_traits_default_address_postal_code,
                    pages.context_traits_default_address_state,
                    pages.context_traits_default_address_street,
                    pages.context_traits_email,
                    pages.context_traits_phone,
                    pages.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    pages.email,
                    NULL AS event,
                    NULL AS event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    pages.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    pages.name,
                    NULL AS order_id,
                    pages.original_timestamp,
                    pages.path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    pages.received_at,
                    NULL AS referree_email,
                    pages.referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    pages.search,
                    NULL AS selling_plan,
                    pages.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    pages.timestamp,
                    pages.title,
                    NULL AS total,
                    NULL AS type,
                    pages.url,
                    pages.user_id,
                    pages.uuid,
                    pages.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.pages


            UNION ALL


        SELECT
        'payment_failure' as src_tbl,
                    payment_failure._id,
                    payment_failure.accepts_marketing,
                    NULL AS action_source,
                    payment_failure.address_city,
                    payment_failure.address_country,
                    payment_failure.address_postal_code,
                    payment_failure.address_state,
                    payment_failure.address_street,
                    NULL AS affiliation,
                    payment_failure.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    payment_failure.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    payment_failure.context_google_analytics_client_id,
                    payment_failure.context_google_analytics_geoid,
                    payment_failure.context_integration_name,
                    payment_failure.context_integration_version,
                    NULL AS context_ip,
                    payment_failure.context_library_name,
                    payment_failure.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    payment_failure.email,
                    payment_failure.event,
                    payment_failure.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    payment_failure.first_name,
                    payment_failure.id,
                    NULL AS image_url,
                    payment_failure.last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    payment_failure.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    payment_failure.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    payment_failure.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    payment_failure.sent_at,
                    payment_failure.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    payment_failure.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    payment_failure.user_id,
                    payment_failure.uuid,
                    payment_failure.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.payment_failure


            UNION ALL


        SELECT
        'payment_info_entered' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    payment_info_entered.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    payment_info_entered.anonymous_id,
                    NULL AS brand,
                    payment_info_entered.cart_id,
                    payment_info_entered.category,
                    payment_info_entered.checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    payment_info_entered.context_external_ids,
                    payment_info_entered.context_google_analytics_client_id,
                    payment_info_entered.context_google_analytics_geoid,
                    payment_info_entered.context_integration_name,
                    payment_info_entered.context_integration_version,
                    payment_info_entered.context_ip,
                    payment_info_entered.context_library_name,
                    payment_info_entered.context_library_version,
                    NULL AS context_locale,
                    NULL AS context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    NULL AS context_page_title,
                    NULL AS context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    NULL AS context_user_agent,
                    payment_info_entered.coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    payment_info_entered.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    payment_info_entered.discount,
                    payment_info_entered.email,
                    payment_info_entered.event,
                    payment_info_entered.event_text,
                    NULL AS fbc,
                    payment_info_entered.fbp,
                    NULL AS first_name,
                    payment_info_entered.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    payment_info_entered.original_timestamp,
                    NULL AS path,
                    payment_info_entered.payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    payment_info_entered.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    payment_info_entered.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    payment_info_entered.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    payment_info_entered.sent_at,
                    payment_info_entered.sent_from,
                    NULL AS shipping,
                    payment_info_entered.shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    payment_info_entered.source_name,
                    NULL AS state,
                    payment_info_entered.step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    payment_info_entered.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    payment_info_entered.user_id,
                    payment_info_entered.uuid,
                    payment_info_entered.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.payment_info_entered


            UNION ALL


        SELECT
        'product_added' as src_tbl,
                    product_added._id,
                    NULL AS accepts_marketing,
                    product_added.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_added.anonymous_id,
                    product_added.brand,
                    product_added.cart_id,
                    product_added.category,
                    NULL AS checkout_id,
                    product_added.compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    product_added.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    product_added.context_integration_name,
                    product_added.context_integration_version,
                    product_added.context_ip,
                    product_added.context_library_name,
                    product_added.context_library_version,
                    product_added.context_locale,
                    product_added.context_page_path,
                    product_added.context_page_referrer,
                    product_added.context_page_search,
                    product_added.context_page_title,
                    product_added.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    product_added.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    product_added.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    product_added.email,
                    product_added.event,
                    product_added.event_text,
                    product_added.fbc,
                    product_added.fbp,
                    NULL AS first_name,
                    product_added.id,
                    product_added.image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    product_added.name,
                    NULL AS order_id,
                    product_added.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    product_added.presentment_amount,
                    product_added.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    product_added.price,
                    product_added.product_id,
                    product_added.products,
                    product_added.properties_action_source,
                    product_added.properties_brand,
                    product_added.properties_cart_id,
                    product_added.properties_category,
                    product_added.properties_compare_at_price,
                    product_added.properties_currency,
                    product_added.properties_email,
                    product_added.properties_image_url,
                    product_added.properties_name,
                    product_added.properties_presentment_amount,
                    product_added.properties_presentment_currency,
                    product_added.properties_price,
                    product_added.properties_product_id,
                    product_added.properties_products,
                    product_added.properties_quantity,
                    product_added.properties_sent_from,
                    product_added.properties_shopify_product_id,
                    product_added.properties_shopify_variant_id,
                    product_added.properties_url,
                    product_added.properties_variant,
                    NULL AS purchase_count,
                    product_added.quantity,
                    NULL AS query,
                    product_added.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_added.sent_at,
                    product_added.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    product_added.shopify_product_id,
                    product_added.shopify_variant_id,
                    product_added.sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    product_added.timestamp,
                    NULL AS title,
                    NULL AS total,
                    product_added.type,
                    product_added.url,
                    product_added.user_id,
                    product_added.uuid,
                    product_added.uuid_ts,
                    product_added.variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_added


            UNION ALL


        SELECT
        'product_added2' as src_tbl,
                    product_added2._id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_added2.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    NULL AS context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    product_added2.context_ip,
                    product_added2.context_library_name,
                    product_added2.context_library_version,
                    product_added2.context_locale,
                    product_added2.context_page_path,
                    product_added2.context_page_referrer,
                    NULL AS context_page_search,
                    product_added2.context_page_title,
                    product_added2.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    product_added2.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    product_added2.event,
                    product_added2.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    product_added2.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    product_added2.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    product_added2.quantity,
                    NULL AS query,
                    product_added2.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_added2.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    product_added2.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    product_added2.uuid,
                    product_added2.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_added2


            UNION ALL


        SELECT
        'product_added3' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_added3.anonymous_id,
                    product_added3.brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    NULL AS context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    product_added3.context_ip,
                    product_added3.context_library_name,
                    product_added3.context_library_version,
                    product_added3.context_locale,
                    product_added3.context_page_path,
                    product_added3.context_page_referrer,
                    NULL AS context_page_search,
                    product_added3.context_page_title,
                    product_added3.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    product_added3.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    product_added3.event,
                    product_added3.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    product_added3.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    product_added3.name,
                    NULL AS order_id,
                    product_added3.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    product_added3.price,
                    product_added3.product_id::TEXT AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    product_added3.quantity,
                    NULL AS query,
                    product_added3.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_added3.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    product_added3.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    product_added3.url,
                    NULL AS user_id,
                    product_added3.uuid,
                    product_added3.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_added3


            UNION ALL


        SELECT
        'product_added4' as src_tbl,
                    product_added4._id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_added4.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    NULL AS context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    product_added4.context_ip,
                    product_added4.context_library_name,
                    product_added4.context_library_version,
                    product_added4.context_locale,
                    product_added4.context_page_path,
                    product_added4.context_page_referrer,
                    NULL AS context_page_search,
                    product_added4.context_page_title,
                    product_added4.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    product_added4.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    product_added4.event,
                    product_added4.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    product_added4.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    product_added4.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    product_added4.quantity,
                    NULL AS query,
                    product_added4.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_added4.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    product_added4.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    product_added4.uuid,
                    product_added4.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_added4


            UNION ALL


        SELECT
        'product_clicked' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_clicked.anonymous_id,
                    product_clicked.brand,
                    NULL AS cart_id,
                    product_clicked.category,
                    NULL AS checkout_id,
                    product_clicked.compare_at_price,
                    product_clicked.context_campaign_content,
                    product_clicked.context_campaign_medium,
                    product_clicked.context_campaign_name,
                    product_clicked.context_campaign_source,
                    NULL AS context_external_ids,
                    product_clicked.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    product_clicked.context_integration_name,
                    product_clicked.context_integration_version,
                    product_clicked.context_ip,
                    product_clicked.context_library_name,
                    product_clicked.context_library_version,
                    product_clicked.context_locale,
                    product_clicked.context_page_path,
                    product_clicked.context_page_referrer,
                    product_clicked.context_page_search,
                    product_clicked.context_page_title,
                    product_clicked.context_page_url,
                    product_clicked.context_traits_default_address_city,
                    product_clicked.context_traits_default_address_country,
                    product_clicked.context_traits_default_address_postal_code,
                    product_clicked.context_traits_default_address_state,
                    product_clicked.context_traits_default_address_street,
                    product_clicked.context_traits_email,
                    product_clicked.context_traits_phone,
                    product_clicked.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    product_clicked.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    product_clicked.email,
                    product_clicked.event,
                    product_clicked.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    product_clicked.id,
                    product_clicked.image_url,
                    NULL AS last_name,
                    product_clicked.list_id,
                    NULL AS marketing_opt_in,
                    product_clicked.name,
                    NULL AS order_id,
                    product_clicked.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    product_clicked.position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    product_clicked.price,
                    product_clicked.product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    product_clicked.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_clicked.sent_at,
                    product_clicked.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    product_clicked.shopify_product_id,
                    product_clicked.shopify_variant_id,
                    product_clicked.sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    product_clicked.tags,
                    NULL AS tax,
                    product_clicked.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    product_clicked.url,
                    product_clicked.user_id,
                    product_clicked.uuid,
                    product_clicked.uuid_ts,
                    product_clicked.variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_clicked


            UNION ALL


        SELECT
        'product_image_clicked' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_image_clicked.anonymous_id,
                    product_image_clicked.brand,
                    NULL AS cart_id,
                    product_image_clicked.category,
                    NULL AS checkout_id,
                    product_image_clicked.compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    product_image_clicked.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    product_image_clicked.context_integration_name,
                    product_image_clicked.context_integration_version,
                    product_image_clicked.context_ip,
                    product_image_clicked.context_library_name,
                    product_image_clicked.context_library_version,
                    product_image_clicked.context_locale,
                    product_image_clicked.context_page_path,
                    product_image_clicked.context_page_referrer,
                    product_image_clicked.context_page_search,
                    product_image_clicked.context_page_title,
                    product_image_clicked.context_page_url,
                    product_image_clicked.context_traits_default_address_city,
                    product_image_clicked.context_traits_default_address_country,
                    product_image_clicked.context_traits_default_address_postal_code,
                    product_image_clicked.context_traits_default_address_state,
                    product_image_clicked.context_traits_default_address_street,
                    product_image_clicked.context_traits_email,
                    product_image_clicked.context_traits_phone,
                    product_image_clicked.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    product_image_clicked.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    product_image_clicked.email,
                    product_image_clicked.event,
                    product_image_clicked.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    product_image_clicked.id,
                    product_image_clicked.image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    product_image_clicked.name,
                    NULL AS order_id,
                    product_image_clicked.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    product_image_clicked.position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    product_image_clicked.price,
                    product_image_clicked.product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    product_image_clicked.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_image_clicked.sent_at,
                    product_image_clicked.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    product_image_clicked.shopify_product_id,
                    product_image_clicked.shopify_variant_id,
                    product_image_clicked.sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    product_image_clicked.tags,
                    NULL AS tax,
                    product_image_clicked.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    product_image_clicked.url,
                    product_image_clicked.user_id,
                    product_image_clicked.uuid,
                    product_image_clicked.uuid_ts,
                    product_image_clicked.variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_image_clicked


            UNION ALL


        SELECT
        'product_list_viewed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_list_viewed.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    product_list_viewed.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    product_list_viewed.context_campaign_content,
                    product_list_viewed.context_campaign_medium,
                    product_list_viewed.context_campaign_name,
                    product_list_viewed.context_campaign_source,
                    NULL AS context_external_ids,
                    product_list_viewed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    product_list_viewed.context_integration_name,
                    product_list_viewed.context_integration_version,
                    product_list_viewed.context_ip,
                    product_list_viewed.context_library_name,
                    product_list_viewed.context_library_version,
                    product_list_viewed.context_locale,
                    product_list_viewed.context_page_path,
                    product_list_viewed.context_page_referrer,
                    product_list_viewed.context_page_search,
                    product_list_viewed.context_page_title,
                    product_list_viewed.context_page_url,
                    product_list_viewed.context_traits_default_address_city,
                    product_list_viewed.context_traits_default_address_country,
                    product_list_viewed.context_traits_default_address_postal_code,
                    product_list_viewed.context_traits_default_address_state,
                    product_list_viewed.context_traits_default_address_street,
                    product_list_viewed.context_traits_email,
                    product_list_viewed.context_traits_phone,
                    product_list_viewed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    product_list_viewed.email,
                    product_list_viewed.event,
                    product_list_viewed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    product_list_viewed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    product_list_viewed.list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    product_list_viewed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    product_list_viewed.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    product_list_viewed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_list_viewed.sent_at,
                    product_list_viewed.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    product_list_viewed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    product_list_viewed.user_id,
                    product_list_viewed.uuid,
                    product_list_viewed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_list_viewed


            UNION ALL


        SELECT
        'product_removed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    product_removed.action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_removed.anonymous_id,
                    product_removed.brand,
                    product_removed.cart_id,
                    product_removed.category,
                    NULL AS checkout_id,
                    product_removed.compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    product_removed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    product_removed.context_integration_name,
                    product_removed.context_integration_version,
                    product_removed.context_ip,
                    product_removed.context_library_name,
                    product_removed.context_library_version,
                    product_removed.context_locale,
                    product_removed.context_page_path,
                    product_removed.context_page_referrer,
                    product_removed.context_page_search,
                    product_removed.context_page_title,
                    product_removed.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    product_removed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    product_removed.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    product_removed.email,
                    product_removed.event,
                    product_removed.event_text,
                    product_removed.fbc,
                    product_removed.fbp,
                    NULL AS first_name,
                    product_removed.id,
                    product_removed.image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    product_removed.name,
                    NULL AS order_id,
                    product_removed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    product_removed.presentment_amount,
                    product_removed.presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    product_removed.price,
                    product_removed.product_id,
                    product_removed.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    product_removed.quantity,
                    NULL AS query,
                    product_removed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_removed.sent_at,
                    product_removed.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    product_removed.shopify_product_id,
                    product_removed.shopify_variant_id,
                    product_removed.sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    product_removed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    product_removed.url,
                    product_removed.user_id,
                    product_removed.uuid,
                    product_removed.uuid_ts,
                    product_removed.variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_removed


            UNION ALL


        SELECT
        'product_viewed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    product_viewed.anonymous_id,
                    product_viewed.brand,
                    NULL AS cart_id,
                    product_viewed.category,
                    NULL AS checkout_id,
                    product_viewed.compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    product_viewed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    product_viewed.context_integration_name,
                    product_viewed.context_integration_version,
                    product_viewed.context_ip,
                    product_viewed.context_library_name,
                    product_viewed.context_library_version,
                    product_viewed.context_locale,
                    product_viewed.context_page_path,
                    product_viewed.context_page_referrer,
                    product_viewed.context_page_search,
                    product_viewed.context_page_title,
                    product_viewed.context_page_url,
                    product_viewed.context_traits_default_address_city,
                    product_viewed.context_traits_default_address_country,
                    product_viewed.context_traits_default_address_postal_code,
                    product_viewed.context_traits_default_address_state,
                    product_viewed.context_traits_default_address_street,
                    product_viewed.context_traits_email,
                    product_viewed.context_traits_phone,
                    product_viewed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    product_viewed.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    product_viewed.email,
                    product_viewed.event,
                    product_viewed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    product_viewed.id,
                    product_viewed.image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    product_viewed.name,
                    NULL AS order_id,
                    product_viewed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    product_viewed.position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    product_viewed.price,
                    product_viewed.product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    product_viewed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    product_viewed.sent_at,
                    product_viewed.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    product_viewed.shopify_product_id,
                    product_viewed.shopify_variant_id,
                    product_viewed.sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    product_viewed.tags,
                    NULL AS tax,
                    product_viewed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    product_viewed.url,
                    product_viewed.user_id,
                    product_viewed.uuid,
                    product_viewed.uuid_ts,
                    product_viewed.variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.product_viewed


            UNION ALL


        SELECT
        'products_searched' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    products_searched.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    products_searched.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    products_searched.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    products_searched.context_integration_name,
                    products_searched.context_integration_version,
                    products_searched.context_ip,
                    products_searched.context_library_name,
                    products_searched.context_library_version,
                    products_searched.context_locale,
                    products_searched.context_page_path,
                    products_searched.context_page_referrer,
                    products_searched.context_page_search,
                    products_searched.context_page_title,
                    products_searched.context_page_url,
                    products_searched.context_traits_default_address_city,
                    products_searched.context_traits_default_address_country,
                    products_searched.context_traits_default_address_postal_code,
                    products_searched.context_traits_default_address_state,
                    products_searched.context_traits_default_address_street,
                    products_searched.context_traits_email,
                    products_searched.context_traits_phone,
                    products_searched.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    products_searched.email,
                    products_searched.event,
                    products_searched.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    products_searched.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    products_searched.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    products_searched.query,
                    products_searched.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    products_searched.results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    products_searched.sent_at,
                    products_searched.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    products_searched.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    products_searched.user_id,
                    products_searched.uuid,
                    products_searched.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.products_searched


            UNION ALL


        SELECT
        'referral_form_submitted' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    referral_form_submitted.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    referral_form_submitted.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    referral_form_submitted.context_ip,
                    referral_form_submitted.context_library_name,
                    referral_form_submitted.context_library_version,
                    referral_form_submitted.context_locale,
                    referral_form_submitted.context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    referral_form_submitted.context_page_title,
                    referral_form_submitted.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    referral_form_submitted.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    referral_form_submitted.email,
                    referral_form_submitted.event,
                    referral_form_submitted.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    referral_form_submitted.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    referral_form_submitted.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    referral_form_submitted.received_at,
                    referral_form_submitted.referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    referral_form_submitted.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    referral_form_submitted.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    referral_form_submitted.user_id,
                    referral_form_submitted.uuid,
                    referral_form_submitted.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.referral_form_submitted


            UNION ALL


        SELECT
        'referral_non_logged_in' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    referral_non_logged_in.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL AS category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    referral_non_logged_in.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL AS context_integration_name,
                    NULL AS context_integration_version,
                    referral_non_logged_in.context_ip,
                    referral_non_logged_in.context_library_name,
                    referral_non_logged_in.context_library_version,
                    referral_non_logged_in.context_locale,
                    referral_non_logged_in.context_page_path,
                    NULL AS context_page_referrer,
                    NULL AS context_page_search,
                    referral_non_logged_in.context_page_title,
                    referral_non_logged_in.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    referral_non_logged_in.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    referral_non_logged_in.email,
                    referral_non_logged_in.event,
                    referral_non_logged_in.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    referral_non_logged_in.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    referral_non_logged_in.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    referral_non_logged_in.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    referral_non_logged_in.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    referral_non_logged_in.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    referral_non_logged_in.user_id,
                    referral_non_logged_in.uuid,
                    referral_non_logged_in.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.referral_non_logged_in


            UNION ALL


        SELECT
        'registration_viewed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    registration_viewed.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    registration_viewed.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    registration_viewed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    registration_viewed.context_integration_name,
                    registration_viewed.context_integration_version,
                    registration_viewed.context_ip,
                    registration_viewed.context_library_name,
                    registration_viewed.context_library_version,
                    registration_viewed.context_locale,
                    registration_viewed.context_page_path,
                    registration_viewed.context_page_referrer,
                    NULL AS context_page_search,
                    registration_viewed.context_page_title,
                    registration_viewed.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    registration_viewed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL AS currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    registration_viewed.event,
                    registration_viewed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    registration_viewed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    registration_viewed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    registration_viewed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    registration_viewed.sent_at,
                    registration_viewed.sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    registration_viewed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    registration_viewed.user_id,
                    registration_viewed.uuid,
                    registration_viewed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.registration_viewed


            UNION ALL


        SELECT
        'thankyou_page_viewed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    thankyou_page_viewed.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    thankyou_page_viewed.category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    thankyou_page_viewed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    thankyou_page_viewed.context_integration_name,
                    NULL AS context_integration_version,
                    thankyou_page_viewed.context_ip,
                    thankyou_page_viewed.context_library_name,
                    thankyou_page_viewed.context_library_version,
                    thankyou_page_viewed.context_locale,
                    thankyou_page_viewed.context_page_path,
                    thankyou_page_viewed.context_page_referrer,
                    NULL AS context_page_search,
                    thankyou_page_viewed.context_page_title,
                    thankyou_page_viewed.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    thankyou_page_viewed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    thankyou_page_viewed.currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    thankyou_page_viewed.discount,
                    thankyou_page_viewed.email,
                    thankyou_page_viewed.event,
                    thankyou_page_viewed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    thankyou_page_viewed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    thankyou_page_viewed.order_id,
                    thankyou_page_viewed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    thankyou_page_viewed.presentment_currency,
                    thankyou_page_viewed.presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    thankyou_page_viewed.products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    thankyou_page_viewed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    thankyou_page_viewed.sent_at,
                    thankyou_page_viewed.sent_from,
                    thankyou_page_viewed.shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    thankyou_page_viewed.tax,
                    thankyou_page_viewed.timestamp,
                    NULL AS title,
                    thankyou_page_viewed.total,
                    NULL AS type,
                    NULL AS url,
                    thankyou_page_viewed.user_id,
                    thankyou_page_viewed.uuid,
                    thankyou_page_viewed.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.thankyou_page_viewed


UNION ALL

        SELECT
        'add_to_registry_clicked' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    add_to_registry_clicked.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL as category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    add_to_registry_clicked.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL as context_integration_name,
                    NULL AS context_integration_version,
                    add_to_registry_clicked.context_ip,
                    add_to_registry_clicked.context_library_name,
                    add_to_registry_clicked.context_library_version,
                    add_to_registry_clicked.context_locale,
                    add_to_registry_clicked.context_page_path,
                    add_to_registry_clicked.context_page_referrer,
                    add_to_registry_clicked.context_page_search,
                    add_to_registry_clicked.context_page_title,
                    add_to_registry_clicked.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    add_to_registry_clicked.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    add_to_registry_clicked.email,
                    add_to_registry_clicked.event,
                    add_to_registry_clicked.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    add_to_registry_clicked.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    add_to_registry_clicked.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    add_to_registry_clicked.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    NULL AS sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    add_to_registry_clicked.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    add_to_registry_clicked.user_id,
                    add_to_registry_clicked.uuid,
                    add_to_registry_clicked.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.add_to_registry_clicked

UNION ALL


        SELECT
        'add_to_registry_modal_opened' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    add_to_registry_modal_opened.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL as category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    add_to_registry_modal_opened.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL as context_integration_name,
                    NULL AS context_integration_version,
                    add_to_registry_modal_opened.context_ip,
                    add_to_registry_modal_opened.context_library_name,
                    add_to_registry_modal_opened.context_library_version,
                    add_to_registry_modal_opened.context_locale,
                    add_to_registry_modal_opened.context_page_path,
                    add_to_registry_modal_opened.context_page_referrer,
                    add_to_registry_modal_opened.context_page_search,
                    add_to_registry_modal_opened.context_page_title,
                    add_to_registry_modal_opened.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    add_to_registry_modal_opened.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    add_to_registry_modal_opened.email,
                    add_to_registry_modal_opened.event,
                    add_to_registry_modal_opened.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    add_to_registry_modal_opened.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    add_to_registry_modal_opened.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    add_to_registry_modal_opened.product_id::TEXT,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    add_to_registry_modal_opened.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    add_to_registry_modal_opened.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    add_to_registry_modal_opened.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    add_to_registry_modal_opened.user_id,
                    add_to_registry_modal_opened.uuid,
                    add_to_registry_modal_opened.uuid_ts,
                    NULL AS variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.add_to_registry_modal_opened

UNION ALL


        SELECT
        'add_to_registry_variant_selected' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    add_to_registry_variant_selected.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL as category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    add_to_registry_variant_selected.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL as context_integration_name,
                    NULL AS context_integration_version,
                    add_to_registry_variant_selected.context_ip,
                    add_to_registry_variant_selected.context_library_name,
                    add_to_registry_variant_selected.context_library_version,
                    add_to_registry_variant_selected.context_locale,
                    add_to_registry_variant_selected.context_page_path,
                    add_to_registry_variant_selected.context_page_referrer,
                    add_to_registry_variant_selected.context_page_search,
                    add_to_registry_variant_selected.context_page_title,
                    add_to_registry_variant_selected.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    add_to_registry_variant_selected.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    add_to_registry_variant_selected.email,
                    add_to_registry_variant_selected.event,
                    add_to_registry_variant_selected.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    add_to_registry_variant_selected.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    add_to_registry_variant_selected.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    add_to_registry_variant_selected.product_id::TEXT,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    add_to_registry_variant_selected.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    add_to_registry_variant_selected.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    add_to_registry_variant_selected.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    add_to_registry_variant_selected.user_id,
                    add_to_registry_variant_selected.uuid,
                    add_to_registry_variant_selected.uuid_ts,
                    add_to_registry_variant_selected.variant_id::TEXT as variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.add_to_registry_variant_selected

UNION ALL

        SELECT
        'add_to_registry_product_added' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    add_to_registry_product_added.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL as category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    add_to_registry_product_added.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL as context_integration_name,
                    NULL AS context_integration_version,
                    add_to_registry_product_added.context_ip,
                    add_to_registry_product_added.context_library_name,
                    add_to_registry_product_added.context_library_version,
                    add_to_registry_product_added.context_locale,
                    add_to_registry_product_added.context_page_path,
                    add_to_registry_product_added.context_page_referrer,
                    add_to_registry_product_added.context_page_search,
                    add_to_registry_product_added.context_page_title,
                    add_to_registry_product_added.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    add_to_registry_product_added.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    add_to_registry_product_added.email,
                    add_to_registry_product_added.event,
                    add_to_registry_product_added.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    add_to_registry_product_added.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    add_to_registry_product_added.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    add_to_registry_product_added.product_id::TEXT,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    add_to_registry_product_added.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    add_to_registry_product_added.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    add_to_registry_product_added.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    add_to_registry_product_added.user_id,
                    add_to_registry_product_added.uuid,
                    add_to_registry_product_added.uuid_ts,
                    add_to_registry_product_added.variant_id::TEXT as variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM shopify_littledata_prod.add_to_registry_product_added

UNION ALL

        SELECT
        'registry_registry_viewed' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    registry_registry_viewed.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL as category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    registry_registry_viewed.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL as context_integration_name,
                    NULL AS context_integration_version,
                    registry_registry_viewed.context_ip,
                    registry_registry_viewed.context_library_name,
                    registry_registry_viewed.context_library_version,
                    registry_registry_viewed.context_locale,
                    registry_registry_viewed.context_page_path,
                    registry_registry_viewed.context_page_referrer,
                    registry_registry_viewed.context_page_search,
                    registry_registry_viewed.context_page_title,
                    registry_registry_viewed.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    registry_registry_viewed.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    registry_registry_viewed.email,
                    registry_registry_viewed.event,
                    registry_registry_viewed.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    registry_registry_viewed.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    registry_registry_viewed.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    registry_registry_viewed.product_id::TEXT,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    registry_registry_viewed.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    registry_registry_viewed.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    registry_registry_viewed.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    registry_registry_viewed.user_id,
                    registry_registry_viewed.uuid,
                    registry_registry_viewed.uuid_ts,
                    registry_registry_viewed.variant_id::TEXT as variant,
                    NULL AS verified_email,
                    registry_customer_id::TEXT
        FROM shopify_littledata_prod.registry_registry_viewed

UNION ALL

        SELECT
        'registry_checkout_started' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    registry_checkout_started.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL as category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    NULL AS context_campaign_content,
                    NULL AS context_campaign_medium,
                    NULL AS context_campaign_name,
                    NULL AS context_campaign_source,
                    NULL AS context_external_ids,
                    registry_checkout_started.context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL as context_integration_name,
                    NULL AS context_integration_version,
                    registry_checkout_started.context_ip,
                    registry_checkout_started.context_library_name,
                    registry_checkout_started.context_library_version,
                    registry_checkout_started.context_locale,
                    registry_checkout_started.context_page_path,
                    NULL AS context_page_referrer,
                    registry_checkout_started.context_page_search,
                    registry_checkout_started.context_page_title,
                    registry_checkout_started.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    registry_checkout_started.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    registry_checkout_started.event,
                    registry_checkout_started.event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    registry_checkout_started.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    registry_checkout_started.original_timestamp,
                    NULL AS path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    registry_checkout_started.received_at,
                    NULL AS referree_email,
                    NULL AS referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    NULL AS search,
                    NULL AS selling_plan,
                    registry_checkout_started.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    registry_checkout_started.timestamp,
                    NULL AS title,
                    NULL AS total,
                    NULL AS type,
                    NULL AS url,
                    NULL AS user_id,
                    registry_checkout_started.uuid,
                    registry_checkout_started.uuid_ts,
                    NULL as variant,
                    NULL AS verified_email,
                    registry_customer_id::TEXT
        FROM shopify_littledata_prod.registry_checkout_started

UNION ALL

        SELECT
        'pages' as src_tbl,
                    NULL AS _id,
                    NULL AS accepts_marketing,
                    NULL AS action_source,
                    NULL AS address_city,
                    NULL AS address_country,
                    NULL AS address_postal_code,
                    NULL AS address_state,
                    NULL AS address_street,
                    NULL AS affiliation,
                    pages.anonymous_id,
                    NULL AS brand,
                    NULL AS cart_id,
                    NULL as category,
                    NULL AS checkout_id,
                    NULL AS compare_at_price,
                    context_campaign_content,
                    context_campaign_medium,
                    context_campaign_name,
                    context_campaign_source,
                    NULL AS context_external_ids,
                    NULL AS context_google_analytics_client_id,
                    NULL AS context_google_analytics_geoid,
                    NULL as context_integration_name,
                    NULL AS context_integration_version,
                    pages.context_ip,
                    pages.context_library_name,
                    pages.context_library_version,
                    pages.context_locale,
                    pages.context_page_path,
                    pages.context_page_referrer,
                    pages.context_page_search,
                    pages.context_page_title,
                    pages.context_page_url,
                    NULL AS context_traits_default_address_city,
                    NULL AS context_traits_default_address_country,
                    NULL AS context_traits_default_address_postal_code,
                    NULL AS context_traits_default_address_state,
                    NULL AS context_traits_default_address_street,
                    NULL AS context_traits_email,
                    NULL AS context_traits_phone,
                    pages.context_user_agent,
                    NULL AS coupon,
                    NULL AS coupon_id,
                    NULL AS created_at,
                    NULL currency,
                    NULL AS customer_lifetime_value,
                    NULL AS default_address_city,
                    NULL AS default_address_country,
                    NULL AS default_address_postal_code,
                    NULL AS default_address_state,
                    NULL AS default_address_street,
                    NULL AS discount,
                    NULL AS email,
                    NULL AS event,
                    NULL AS event_text,
                    NULL AS fbc,
                    NULL AS fbp,
                    NULL AS first_name,
                    pages.id,
                    NULL AS image_url,
                    NULL AS last_name,
                    NULL AS list_id,
                    NULL AS marketing_opt_in,
                    NULL AS name,
                    NULL AS order_id,
                    pages.original_timestamp,
                    pages.path,
                    NULL AS payment_method,
                    NULL AS phone,
                    NULL AS position,
                    NULL AS presentment_amount,
                    NULL AS presentment_currency,
                    NULL AS presentment_total,
                    NULL AS previous_id,
                    NULL AS price,
                    NULL AS product_id,
                    NULL AS products,
                    NULL AS properties_action_source,
                    NULL AS properties_brand,
                    NULL AS properties_cart_id,
                    NULL AS properties_category,
                    NULL AS properties_compare_at_price,
                    NULL AS properties_currency,
                    NULL AS properties_email,
                    NULL AS properties_image_url,
                    NULL AS properties_name,
                    NULL AS properties_presentment_amount,
                    NULL AS properties_presentment_currency,
                    NULL AS properties_price,
                    NULL AS properties_product_id,
                    NULL AS properties_products,
                    NULL AS properties_quantity,
                    NULL AS properties_sent_from,
                    NULL AS properties_shopify_product_id,
                    NULL AS properties_shopify_variant_id,
                    NULL AS properties_url,
                    NULL AS properties_variant,
                    NULL AS purchase_count,
                    NULL AS quantity,
                    NULL AS query,
                    pages.received_at,
                    NULL AS referree_email,
                    pages.referrer,
                    NULL AS refund_reason,
                    NULL AS results,
                    NULL AS revenue,
                    pages.search,
                    NULL AS selling_plan,
                    pages.sent_at,
                    NULL AS sent_from,
                    NULL AS shipping,
                    NULL AS shipping_method,
                    NULL AS shopify_product_id,
                    NULL AS shopify_variant_id,
                    NULL AS sku,
                    NULL AS source_name,
                    NULL AS state,
                    NULL AS step,
                    NULL AS subtotal,
                    NULL AS tags,
                    NULL AS tax,
                    pages.timestamp,
                    pages.title,
                    NULL AS total,
                    NULL AS type,
                    pages.url,
                    pages.user_id,
                    pages.uuid,
                    pages.uuid_ts,
                    NULL as variant,
                    NULL AS verified_email,
                    NULL AS registry_customer_id
        FROM landing_pages.pages
)
, all_events AS (
    SELECT 
        base.*
        , COALESCE(id_map.member_id, id_map2.member_id, base.user_id, base.anonymous_id) AS master_user_id
    FROM base
    LEFT JOIN {{ref('member_id_map')}} id_map
        on id_map.src_id = anonymous_id
        and id_map.src = 'segment'
    LEFT JOIN {{ref('member_id_map')}} id_map2
        on id_map2.src_id = base.user_id
        and id_map2.src = 'shopify'
)
, session_maker as (
    select *
        , case
            when datediff('s',
                    lag(timestamp) over(
                        partition by master_user_id
                        order by timestamp
                    ),
                    timestamp
                ) > 60 * 30
                OR lag(timestamp) over(
                        partition by master_user_id
                        order by timestamp
                    ) IS NULL
            then id end as session_id_tmp
    from all_events
)
, sessioned_events as (
    select *
        , last_value(session_id_tmp IGNORE NULLS) over (order by master_user_id, timestamp rows unbounded preceding) as session_id
    from session_maker
)
select *
from sessioned_events
